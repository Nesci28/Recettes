<div *ngIf="meal">
  <div>
    <button class="btn btn-success mr-5" (click)="changeToModification()">
      Modifier
    </button>
    <h2 class="d-inline vertical-align-middle">{{ meal.name }}</h2>
  </div>

  <div *ngIf="meal" class="mt-3">
    <div class="row mx-auto">
      <div class="col-sm-6 img-responsive">
        <div class="img-thumbnail">
          <img
            [src]="getImage()"
            style="border-radius: 255px 25px 225px 25px/25px 225px 25px 255px;"
            alt="Aucune image"
            class="w-100"
          />
        </div>
      </div>
      <div class="col-sm-6">
        <ul class="list-group row mx-auto flex-row">
          <li
            *ngFor="let ingredient of meal.ingredients"
            class="list-group-item d-flex justify-content-between align-items-center pointer w-50"
            [ngClass]="{
              'list-disabled': ingredient.disabled,
              'ingredient-legume': ingredient.type === 'légume',
              'ingredient-viande': ingredient.type === 'viande',
              'ingredient-poisson': ingredient.type === 'poisson',
              'ingredient-dairy': ingredient.type === 'dairy',
              'ingredient-fruit': ingredient.type === 'fruit',
              'ingredient-autre': ingredient.type === 'autre'
            }"
            (click)="ingredient.disabled = !ingredient.disabled"
          >
            {{ ingredient.ingredient }}
            <span class="badge badge-primary badge-pill">{{
              ingredient.quantity
            }}</span>
          </li>
        </ul>
      </div>
    </div>

    <div class="mt-3 col-md-12">
      <ul class="list-group">
        <li
          *ngFor="
            let instruction of meal.instructions;
            index as i;
            let odd = odd
          "
          class="list-group-item d-flex justify-content-between align-items-center pointer p-0"
          [ngClass]="[odd ? 'list-odd' : '']"
        >
          <span class="input-group-text" [ngClass]="[odd ? 'list-odd' : '']">{{
            i + 1
          }}</span>

          <div class="d-flex w-100">
            <div
              *ngFor="let step of instruction; let last = last"
              [ngClass]="step.selected ? 'w-100' : ''"
            >
              <div
                [ngClass]="[
                  step.selected ? 'instruction-show' : 'instruction-hidden',
                  !last ? 'instruction-divider-not-last' : '',
                  step.disabled ? 'list-disabled' : ''
                ]"
                class="d-flex px-3 justify-content-between"
                (click)="showOrDisableInstruction(instruction, step)"
              >
                {{ step.selected ? step.instruction : step.author }}
                <span
                  *ngIf="step.disabled"
                  class="badge badge-primary badge-pill text-decoration-none"
                  >Finit</span
                >
              </div>
            </div>
          </div>
        </li>
      </ul>
    </div>
  </div>
  <button
    [useExistingCss]="true"
    [printStyle]="{ body: { 'background-color': 'white !important' } }"
    printSectionId="print-section"
    ngxPrint
    class="btn btn-info mt-3 mr-3"
  >
    Imprimer sans photo
  </button>
  <button
    [useExistingCss]="true"
    [printStyle]="{ body: { 'background-color': 'white !important' } }"
    printSectionId="print-section"
    ngxPrint
    class="btn btn-info mt-3"
  >
    Imprimer avec photo
  </button>
</div>

<div *ngIf="meal" [hidden]="true" id="print-section" class="bg-white">
  <h1 class="text-center">{{ meal.name }}</h1>
  <div class="mt-3 col-md-12">
    <h3 class="mt-5">Ingredients:</h3>
    <ul class="list-group row mx-auto flex-row">
      <li
        *ngFor="let ingredient of meal.ingredients"
        class="list-group-item d-flex justify-content-between align-items-center col-sm-6 col-md-6 col-lg-4"
        [ngClass]="{
          'list-disabled': ingredient.disabled,
          'ingredient-legume': ingredient.type === 'légume',
          'ingredient-viande': ingredient.type === 'viande',
          'ingredient-poisson': ingredient.type === 'poisson',
          'ingredient-dairy': ingredient.type === 'dairy',
          'ingredient-fruit': ingredient.type === 'fruit',
          'ingredient-autre': ingredient.type === 'autre'
        }"
      >
        {{ ingredient.ingredient }}
        <span class="badge badge-primary badge-pill">{{
          ingredient.quantity
        }}</span>
      </li>
    </ul>
  </div>

  <div class="mt-3 col-md-12">
    <h3 class="mt-5">Instructions:</h3>
    <ul class="list-group">
      <li
        *ngFor="let instruction of meal.instructions; index as i; let odd = odd"
        class="list-group-item d-flex justify-content-between align-items-center pointer px-0"
        [ngClass]="[odd ? 'list-odd' : '']"
      >
        <span class="input-group-text" [ngClass]="[odd ? 'list-odd' : '']">{{
          i + 1
        }}</span>
        <div class="d-flex w-100">
          <div
            *ngFor="let step of instruction; let last = last"
            [ngClass]="step.selected ? 'w-100' : ''"
          >
            <div
              [ngClass]="[
                step.selected ? 'instruction-show' : 'instruction-hidden',
                !last ? 'instruction-divider-not-last' : '',
                step.disabled ? 'list-disabled' : ''
              ]"
              class="d-flex px-3 justify-content-between"
              (click)="showOrDisableInstruction(instruction, step)"
            >
              {{ step.selected ? step.instruction : step.author }}
              <span
                *ngIf="step.disabled"
                class="badge badge-primary badge-pill text-decoration-none"
                >Finit</span
              >
            </div>
          </div>
        </div>
      </li>
    </ul>
  </div>
</div>
